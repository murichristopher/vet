<script>
  document.addEventListener('DOMContentLoaded', function() {
  var Calendar = FullCalendar.Calendar;
  var Draggable = FullCalendar.Draggable;

  var containerEl = document.getElementById('external-events');
  var calendarEl = document.getElementById('calendar');
  var checkbox = document.getElementById('drop-remove');

  // initialize the external events
  // -----------------------------------------------------------------

  new Draggable(containerEl, {
    itemSelector: '.fc-event',
    eventData: function(eventEl) {
      return {
        title: eventEl.innerText
      };
    }
  });

  // initialize the calendar
  // -----------------------------------------------------------------

  var calendar = new Calendar(calendarEl, {
    headerToolbar: {
      left: 'prev,next today',
      center: 'title',
      right: 'dayGridMonth,timeGridWeek,timeGridDay'
    },
    editable: true,
    droppable: true, // this allows things to be dropped onto the calendar
    selectable: true,
    drop: function(info) {
      // is the "remove after drop" checkbox checked?
        // if so, remove the element from the "Draggable Events" list
        info.draggedEl.parentNode.removeChild(info.draggedEl);
    },
       dateClick: function(info) {
        $('#event-modal').modal('show');
        $('#event-date').val(info.dateStr);

        this.addEvent({
          title: 'cabreiro',
          start: '2024-02-13',
        });
      }

  });

  calendar.render();

  document.getElementById('event-form').addEventListener('submit', function(e) {



    e.preventDefault();
  var eventName = document.getElementById('event-name').value.trim();
    var eventColor = document.getElementById('event-color').value;
    if (eventName) {
      // Create a new event element
      var eventEl = document.createElement('div');
      eventEl.classList.add('fc-event');
      eventEl.innerHTML = `<div class='fc-event-main'>${eventName}</div>`;
      eventEl.setAttribute('data-color', eventColor); // Store the color in a data attribute
      eventEl.style.borderColor = eventColor; // Optional: Use the color for the border
      eventEl.style.backgroundColor = eventColor; // Optional: Use the color for the background

      // Add the new event to the container
      containerEl.appendChild(eventEl);

      // Reset form fields
      document.getElementById('event-name').value = '';
      document.getElementById('event-color').value = '#000000';

      // Make the new event draggable
      new Draggable(containerEl, {
        itemSelector: '.fc-event',
        eventData: function(eventEl) {
          return {
            title: eventEl.innerText,
            color: eventEl.getAttribute('data-color')
          };
        }
      });
    }
  })

  });
</script>
<div id='external-events'>
  <p><strong>Draggable Events</strong></p>
  <!-- Form for adding new draggable events -->
  <form id="event-form">
    <input type="text" id="event-name" placeholder="Event Name" required />
    <input type="color" id="event-color" required />
    <button type="submit">Add Event</button>
  </form>
  <!-- Existing draggable events -->
  <!-- Draggable events will be added here dynamically -->
</div>
<div id='calendar-container'>
  <div id='calendar'></div>
</div>
<div class="modal fade" id="event-modal" tabindex="-1" role="dialog" aria-labelledby="eventModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="eventModalLabel">New Event</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="form-group">
            <label for="event-name-modal">Event Name</label>
            <input type="text" class="form-control" id="event-name-modal" placeholder="Enter event name">
          </div>
          <div class="form-group">
            <label for="event-color-modal">Event Color</label>
            <input type="color" class="form-control" id="event-color-modal">
          </div>
          <input type="hidden" id="event-date">
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="save-event">Save Event</button>
      </div>
    </div>
  </div>
</div>
<!-- Cloudflare Pages Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "dc4641f860664c6e824b093274f50291"}'></script><!-- Cloudflare Pages Analytics -->
<style>
  html, body {
    margin: 0;
    padding: 0;
    font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
    font-size: 14px;
  }

  #external-events {
    position: fixed;
    z-index: 2;
    top: 20px;
    left: 20px;
    width: 150px;
    padding: 0 10px;
    border: 1px solid #ccc;
    background: #eee;
  }

  #external-events .fc-event {
    cursor: move;
    margin: 3px 0;
  }

  #calendar-container {
    position: relative;
    z-index: 1;
    margin-left: 200px;
  }

  #calendar {
    max-width: 1100px;
    margin: 20px auto;
  }
</style>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
